<!DOCTYPE html>
<html><head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

    <title>I looked out the window and saw it was grey outside - While in the lab</title>

    
    
    <meta name="description" content="But I wondered how grey? Rochester has some of the greyest skies of all cities in the United States but after 9 years here, this felt like one of the sunniest winters ever. I couldn’t prove it, but I did want to compare the sky colors across months and hopefully see trends over a few years.
I had remembered previously seeing a NYC sky color website and loved the idea. I wanted to build something similar but for Rochester but also build out a dataset for future comparisons." />
    <meta name="author" content="" />
    

    <link href="https://unpkg.com/@master/normal.css" rel="stylesheet">
    <script src="https://unpkg.com/@master/style@1.5.0"></script>
    <script src="https://unpkg.com/@master/styles@1.13.0"></script>
    <script src="https://unpkg.com/master-styles-group"></script>
    <script src="https://unpkg.com/themes.js"></script>
    <script>window.themes = window.themes || new window.Themes()</script>

    <style>
        :root {
            --font-sans: "Inter var", ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica Neue, Arial, Noto Sans, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol, Noto Color Emoji;
        }
    </style></head>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-R6YPR17YY6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-R6YPR17YY6');
</script><body class="bg:fade-84@dark font:fade-16@dark font:sans">
    
<nav class="w:full h:90 fixed bg:fade-84/.95@dark bg:white z:1000">
    <div class="
        h:full
        w:full
        max-w:1200
        mx:auto
        px:32
        d:flex
        align-items:center
    ">
        <div>
            <a href="/" class="mr-3 font:extralight">
              
              While in the lab
              
            </a>
        </div>

        <div class="ml:auto">
            
            
            
        </div>
    </div>
</nav>
<div class="d:flex flex:column@<=sm pt:90 px:24 jc:center gap:44 word-break:break-word">
        <div class="max-w:700 w:full box:content-box">
<article class="box:border-box pt:32">
    <header class="mb:32">
        <div class="font:40 font:extrabold">I looked out the window and saw it was grey outside</div>
        <div class="mt:16 f:fade-60">
            <time>Feb 13, 2024</time>
            </div>
    </header><div class="
    _:where(a):hover{text-decoration-color:fade}
    _:where(a){text-decoration:2;underline;fade-10;_text-decoration-color:fade-70@dark}
    _:where(blockquote){bl:5;solid;fade-76/.1;_bl:5;solid;fade-34/.1@dark}
    _:where(code){font:90%;_v:middle}
    _:where(code:not(.highlight_*,pre_*)){p:2;6;_r:4}
    _:where(del){text-decoration:1;line-through;fade-68;_text-decoration-color:red-64@dark}
    _:where(figcaption){text:14;_p:10;20;0;_width:fit;_mx:auto;_font:fade-56;_font:fade-57@dark}
    _:where(h1){font:40;_font:extrabold}
    _:where(h1,h2,h3)+:where(h1,h2,h3){mt:.5em}
    _:where(h1,h2,h3,h4,h5,h6){mt:2em}
    _:where(h2){mb:1em;_font:32}
    _:where(h3){font:24}
    _:where(h4){font:20}
    _:where(h5){font:16}
    _:where(h6){font:14}
    _:where(li)::marker{font:fade-44;_font:fade-68@dark}
    _:where(li){pl:.375em}
    _:where(mark){text-decoration:1;underline;#fce016;_bg:transparent;_text-decoration-color:rgb(252;224;22/.5)@dark}
    _:where(p,li){font:fade-76;_font:16;_line-height:1.65;_font:fade-34@dark}
    _:where(p,pre,blockquote,figure,ul,ol,table){my:1.125em}
    >:first-child{mt:0!}
    _:where(pre){p:20;_r:8;_overflow:auto}
    _:where(pre,code:not(.highlight_*)){bg:fade-2;_bg:fade-92!@dark}
    _:where(strong,b,a,code:not(.highlight_*),mark,del){font:fade-92;_font:fade-12@dark}
    _:where(table){width:full;_border-spacing:0}
    _:where(td){v:baseline}
    _:where(td,th):first-child{pl:0}
    _:where(td,th):last-child{pr:0}
    _:where(td,th){bb:1;solid;fade-92/.06;_p:6;_b:fade-4/.04@dark}
    _:where(th){font:fade-78;_font:14;_text:left;_font:fade-12@dark}
    _:where(th,p_code,li_code,a,mark){font:semibold;_font:medium@dark}
    _:where(ul){list-style-type:disc}
    _:where(ul,ol,blockquote){pl:1.5em}
    _:where(video,img){max-width:full}
    _:where(a,mark){text-underline-offset:3}
    _:where(hr){h:2;_bg:fade-10;_bg:fade-70@dark;_my:3em}
"><p>But I wondered how grey? Rochester has <a href="https://www.statista.com/statistics/226760/us-cities-with-the-most-cloudy-days/">some of the greyest skies of all cities in the United States</a> but after 9 years here, this felt like one of the sunniest winters ever. I couldn’t prove it, but I did want to compare the sky colors across months and hopefully see trends over a few years.</p>
<p>I had remembered previously seeing a <a href="https://nskyc.com">NYC sky color</a> website and loved the idea. I wanted to build something similar but for Rochester but also build out a dataset for future comparisons. This also gave me the chance to play around with another cloud service (I usually use Digital Ocean for all my hosting needs).</p>
<h2 id="finding-the-camera">Finding the camera</h2>
<p>To constantly update with what the sky looks like, I needed a video camera to constantly take pictures. I could’ve set up a livestream camera at my apartment and pointed it straight up or at the skyline, but</p>
<ul>
<li>For one reason or another I move to a different part of the city every few semesters and didn’t want a change in location to affect anything. Worse, I didn’t want to give out my apartment location on the internet</li>
<li>My current wifi is a bit finicky</li>
<li>Didn’t want to break the near-zero budget with a computer/raspberry Pi situation</li>
</ul>
<p>This led me to look for livestreams that were already active online. My exclusion criteria was based on how stable (not likely to move and have continuous uptime) the camera was, how clear the sky was in the video’s picture, and ease of saving images from it.</p>
<p>I looked for a few livestreams online and found the Genesee Valley Audubon Society’s <a href="https://rfalconcam.com/rfc-main/">falcon cams</a>. I had never heard of this before but they have, for 25 years, kept a series of cameras on  nest boxes that falcons live in, in the area. The picture quality was great but after taking a few sample images, I realized the cameras moved every now and again to focus on the birds, so the position of the sky wouldn’t be the same. The livestream wasn’t a good fit but it’s always fun to learn more about local Rochester history and the people who make great stuff here.</p>
<p>I kept searching and found New York State (NYS) traffic cams. They were all over the county, and a few highways, and were not likely to move. Best part was that they have developer access!</p>
<!-- raw HTML omitted -->
<p><img src="https://jspann.me/blog_images/nys_cam_side.png" alt=""></p>
<!-- raw HTML omitted -->
<p>In late December 2023 I applied to get access to the service…and never heard back. Looking closer at the videos later, I realized this wouldn’t be a good fit since many of the videos were black and white, or just looked at the road and gave a narrow view of the sky that could be blocked by the glare from a nearby street lamp.</p>
<p>After more searching I took a break and watched the news with my Dad.
…<em><strong>The news!</strong></em></p>
<p>Sometimes during local weather reports, the reporter will stand in front of a livestream of the weather outside to share their report (like so: <a href="https://www.youtube.com/watch?v=2Yb_VA4L3YU">https://www.youtube.com/watch?v=2Yb_VA4L3YU</a>). The cameras don’t move (and aren’t likely to do so), contain sizable portions of the sky, and are constantly running. After some light searching I even realized they’re shared <a href="https://www.whec.com/first-alert-live-camera-network/">online</a>! I sent some cold emails to a few local stations and eventually got permission to use a weather camera pointed at Lake Ontario and the color filled sky above it. The camera feed was updated hourly and would be trivial to download from a publicly available web address on their site.</p>
<p><img src="https://jspann.me/blog_images/camera_screenshot.jpg" alt=""></p>
<!-- raw HTML omitted -->
<h2 id="what-is-an-average-sky">What is an average sky?</h2>
<p>I wrote a python script to grab the top quarter of the image (the sky part) 5 minutes after the start of every hour (1:05a, 2:05a, …) with crontab. It saves it to a Google Cloud VM Instance (e2-micro) that was paid for with credits that I got from a hackathon a few years back. Google Cloud has a lot of tools and features, but it’s way more organized and intuitive than when I first tried using it in undergrad. There were some quirks but I get why it’s a heavily used service.</p>
<p>One question I came across was the difference between the average color and the dominant color. The former is a mean of pixel values (average of the red in each pixel, average of green in each pixel, average of blue in each pixel), while the latter is the color that is the most common and stands out in the image. I found the dominant image with K-means clustering (<a href="https://stackoverflow.com/questions/43111029/how-to-find-the-average-colour-of-an-image-in-python-with-opencv">based on this SO answer</a>) and saved that as an image was taken.</p>
<p>The site is a Flask template with the most recent photo from the lighthouse live stream at the top, the most recent colors of the sky (and their hex values) decending below, and a link to a chart of the sky&rsquo;s colors (which is described in the next section).</p>
<!-- raw HTML omitted -->
<p><img src="https://jspann.me/blog_images/full_sky_site.png" alt=""></p>
<h2 id="how-much-does-the-sky-change">How much does the sky change?</h2>
<p>To address my initial question, I have the system plot a distribution of sky colors associated with the sun’s height when the photo was taken. In other words, it is a hour of the day in Rochester (ex. 2p = Hour 14) vs. height of the sun in the sky graph, where I plot the color of the sky at that time on the graph. I did this with <a href="http://docs.pysolar.org/en/latest/">PySolar</a>, which has the funny subtitle of “staring directly at the sun since 2007”. After learning the difference between azimuth and altitude, and adding some jitter so I could see the different colors that could happen at each hour, I got a fun graph like this:
<img src="https://jspann.me/blog_images/sky_plot.png" alt=""></p>
<!-- raw HTML omitted -->
<p>For now it is just a few data points from the past month (since I started recording image data on January 11th 2024) but over time I hope to get more detail on how the sky’s colors shift during the year and eventually make plots like this to compare monthly.</p>
<p>Thanks for reading and if you want to play around with the tool you can at my website <a href="http://rocsky.jspann.me">rocsky.jspann.me</a> .</p>
</div></article>
<footer class="py:24">
    <div class="f:fade-30 f:14 mb:8"></div>
    <div class="f:fade-60 f:12">Theme <a class="f:bold" href="https://github.com/serkodev/holy" _target="_blank">Holy</a></div>
</footer></div>
    </div>
</body>

</html>